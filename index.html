<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë„ì¿„ ê°€ì¡±ì—¬í–‰ 2026 ğŸ‡¯ğŸ‡µ</title>
    <style>
        :root { --main: #ff4757; --bg: #f8f9fa; --card: #ffffff; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 100px; color: #333; }
        #lock-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--main); color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; }
        #pw-input { width: 180px; padding: 15px; border: none; border-radius: 10px; text-align: center; font-size: 1.5rem; margin-bottom: 20px; outline: none; letter-spacing: 5px; }
        #lock-screen button { padding: 12px 40px; border: none; border-radius: 25px; background: white; color: var(--main); font-weight: bold; cursor: pointer; }
        #app-content { display: none; }
        .header { background: var(--main); color: white; padding: 15px; text-align: center; position: sticky; top: 0; z-index: 100; font-weight: bold; }
        .card { background: var(--card); margin: 15px; padding: 20px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); display: none; }
        .card.active { display: block; }
        h2 { font-size: 1.1rem; color: var(--main); margin-top: 0; border-bottom: 2px solid #fff0f1; padding-bottom: 8px; }
        .info-item { font-size: 0.85rem; margin-bottom: 8px; padding-left: 10px; border-left: 3px solid #ff4757; line-height: 1.5; white-space: pre-wrap; }
        .photo-container { position: relative; display: inline-block; margin: 5px; }
        .photo-item { width: 95px; height: 95px; object-fit: cover; border-radius: 10px; border: 1px solid #eee; }
        .del-btn { position: absolute; top: -5px; right: -5px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 50%; width: 22px; height: 22px; font-size: 12px; }
        textarea { width: 100%; height: 100px; border: 1px solid #eee; border-radius: 10px; padding: 10px; margin-top: 15px; box-sizing: border-box; background: #fffdf0; font-size: 0.85rem; }
        .upload-btn { display: inline-block; padding: 8px 15px; background: #f0f0f0; border-radius: 8px; font-size: 0.8rem; cursor: pointer; margin-top: 10px; border: 1px solid #ddd; font-weight: bold; }
        .nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; border-top: 1px solid #eee; height: 75px; z-index: 100; }
        .nav-item { flex: 1; text-align: center; padding: 12px 0; color: #999; cursor: pointer; font-size: 0.75rem; }
        .nav-item.active { color: var(--main); font-weight: bold; background: #fffafa; }
    </style>
</head>
<body>

<div id="lock-screen">
    <h2>ğŸ”‘ ê°€ì¡± ì „ìš© ì•”í˜¸</h2>
    <input type="password" id="pw-input" maxlength="4" placeholder="4ìë¦¬" inputmode="numeric">
    <button onclick="checkPassword()">ì…ì¥í•˜ê¸°</button>
</div>

<div id="app-content">
    <div class="header">ë„ì¿„ ê°€ì¡±ì—¬í–‰ 2026 ğŸ‡¯ğŸ‡µ</div>

    <div id="day1" class="card active">
        <h2>DAY 1: ê³µí•­ & ë„ì¿„íƒ€ì›Œ (1/16)</h2>
        <div class="info-item">âœˆï¸ 15:00 ë‚˜ë¦¬íƒ€ê³µí•­(T2) ë„ì°© ë° ì…êµ­ ì‹¬ì‚¬
ğŸ’° ìŠ¤ì´ì¹´ ë°œê¸‰ (ë‚˜ë¦¬íƒ€ T2 B1F JR Travel Center)
ğŸš† ë‚˜ë¦¬íƒ€ â†’ ì•„ì‚¬ì¿ ì‚¬ (Access Express ì§í–‰, 1,370ì—”)
ğŸ¨ ì•„ì‚¬ì¿ ì‚¬ì—­ A4 ì¶œêµ¬ â†’ í˜¸í…” ë„ë³´ 7~8ë¶„
ğŸ—¼ ë„ì¿„íƒ€ì›Œ ì´ë™: ì•„ì‚¬ì¿ ì‚¬ì„  1ë²ˆ â†’ ë‹¤ì´ëª¬ì—­(27ë¶„)
ğŸ´ ì €ë… ì¶”ì²œ: ë¼ë©˜ ì¹´ë‚˜ë‹¤ì•¼ / ë‚œìŠ¤ì¼€ ë°”ì´ìŠ¤ / í† ë¦¬í‚¤ì¡°ì¿ 
ğŸŒ™ ì•„ì‚¬ì¿ ì‚¬ ì•¼ê°„ ì‚°ì±… & ëˆí‚¤í˜¸í…Œ (24ì‹œê°„)</div>
        <div id="photos-day1"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day1', this)"></label>
        <textarea id="memo-day1" onblur="saveMemo('day1')" placeholder="ë©”ëª¨ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”!"></textarea>
    </div>

    <div id="day2" class="card">
        <h2>DAY 2: í•´ë¦¬í¬í„° & ìŠ¤ì¹´ì´íŠ¸ë¦¬ (1/17)</h2>
        <div class="info-item">ğŸ³ 08:00 ì•„ì¹¨ì‹ì‚¬: ìš”ì‹œë…¸ì•¼ (ê·œë™/ë¯¸ì†Œì‹œë£¨ ì„¸íŠ¸)
ğŸ§™â€â™‚ï¸ 09:00 í•´ë¦¬í¬í„° ìŠ¤íŠœë””ì˜¤ íˆ¬ì–´ ì¶œë°œ
ğŸ›¤ï¸ ê²½ë¡œ: í˜¸í…”â†’ì•„ì‚¬ì¿ ì‚¬ì„ (ë¹¨ê°•)â†’ì˜¤ì‹œì•„ê²Œì—­ í™˜ìŠ¹â†’í•œì¡°ëª¬ì„ (ë³´ë¼)â†’ì‹œë¶€ì•¼ì—­(JRí™˜ìŠ¹)â†’JRì•¼ë§ˆë…¸í…Œì„ (ì´ˆë¡)â†’ì´ì¼€ë¶€ì¿ ë¡œâ†’ì„¸ì´ë¶€ì„ (ë…¸ë‘)â†’ë„ì‹œë§ˆì—”
âš¡ 10:30~13:30 í•´ë¦¬í¬í„° ìŠ¤íŠœë””ì˜¤ íˆ¬ì–´ (ì‚¬ì§„ í¬ì¸íŠ¸ ë§ìŒ)
ğŸ—¼ 15:00~17:00 ìŠ¤ì¹´ì´íŠ¸ë¦¬ ì „ë§ëŒ€ & ì‡¼í•‘(Solamachi)
ğŸŒ™ 18:00 ì•„ì‚¬ì¿ ì‚¬ ê·€ê°€ ë° ì•¼ê°„ì‚°ì±… (ë©œë¡ ë¹µ/ë‚˜ì¹´ë¯¸ì„¸)</div>
        <div id="photos-day2"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day2', this)"></label>
        <textarea id="memo-day2" onblur="saveMemo('day2')"></textarea>
    </div>

    <div id="day3" class="card">
        <h2>DAY 3: íˆì—ì‹ ì‚¬ & ì‹œë¶€ì•¼ (1/18)</h2>
        <div class="info-item">â›©ï¸ 10:00~11:00 íˆì—ì‹ ì‚¬ (ë¶‰ì€ í† ë¦¬ì´ í¬í† ì¡´)
ğŸ­ 11:45 ì•„ì¹´ì‚¬ì¹´ ACT ì”¨ì–´í„° ì…ì¥
ğŸª„ 12:15 í•´ë¦¬í¬í„° ê³µì—° ì‹œì‘ (ì•½ 3ì‹œê°„ 30ë¶„ ì†Œìš”)
ğŸ™ï¸ 16:00 ì‹œë¶€ì•¼ ì´ë™ ë° ì‹ì‚¬ (ì´ì¹˜ë€ ë¼ë©˜/ìŠ¤í‚¤ì•¼)
âœ¨ 17:00~18:00 ì‹œë¶€ì•¼ ìŠ¤ì¹´ì´ ì „ë§ëŒ€ ê´€ëŒ
ğŸ›ï¸ 18:00~20:00 ì‹œë¶€ì•¼ ì‡¼í•‘ ë° ê°€ì± ìƒµ
ğŸ¨ 21:00 í˜¸í…” ë„ì°© ë° íœ´ì‹</div>
        <div id="photos-day3"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day3', this)"></label>
        <textarea id="memo-day3" onblur="saveMemo('day3')"></textarea>
    </div>

    <div id="day4" class="card">
        <h2>DAY 4: ë””ì¦ˆë‹ˆì”¨ íƒí—˜ (1/19)</h2>
        <div class="info-item">ğŸ¡ ê²½ë¡œ: ì•„ì‚¬ì¿ ì‚¬ì—­â†’íˆê°€ì‹œê¸´ìâ†’ì‹ ë°”ì‹œâ†’ë§ˆì´í•˜ë§ˆ(JR ê²Œì´ìš”ì„ )
ğŸ´ ì‹ì‚¬ ì¶”ì²œ: ì„¸ì¼ë§ë°ì´ ë·”í˜ / ì¹´ìŠ¤í”¼ì•ˆ ìŠ¤ë‚µ / ë¦¬ìŠ¤íŠ¸ë€í…Œ ë”” ì¹´ë‚˜ë ›í† 
ğŸ¢ ìŠ¤ë¦´ ê¸°êµ¬: ì €ë‹ˆ íˆ¬ ë” ì„¼í„° ì˜¤ë¸Œ ë” ì–´ìŠ¤ / íƒ€ì›Œ ì˜¤ë¸Œ í…ŒëŸ¬ / ì¸ë””ì•„ë‚˜ ì¡´ìŠ¤
ğŸ§¸ ê°€ì¡±ìš©: ì•„ì¿ ì•„í† í”¼ì•„ / ë§¤ì§€ì»¬ ë¨í”„ ì”¨ì–´í„°
ğŸ† ì €ë… ì‡¼: Believe! Sea of Dreams (ì•¼ê°„ í•˜ë²„ì‡¼)</div>
        <div id="photos-day4"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day4', this)"></label>
        <textarea id="memo-day4" onblur="saveMemo('day4')"></textarea>
    </div>

    <div id="day5" class="card">
        <h2>DAY 5: ì‹œì¥ êµ¬ê²½ & ê·€êµ­ (1/20)</h2>
        <div class="info-item">ğŸ£ ì˜¤ì „: ì¸ í‚¤ì§€ ì¥ì™¸ ì‹œì¥ íˆ¬ì–´
ğŸš† ë‚˜ë¦¬íƒ€í–‰ ì—´ì°¨ ì•ˆë‚´: 2ë²ˆ í”Œë«í¼ (ë‚˜ë¦¬íƒ€ ë°©í–¥ í™•ì¸)
ğŸ« ìš”ê¸ˆ: 1,320ì—” (ìŠ¤ì´ì¹´ ê²°ì œ ê°€ëŠ¥)
â±ï¸ ì†Œìš”ì‹œê°„: ì•½ 55~60ë¶„ (í™˜ìŠ¹ ì—†ìŒ)
âœˆï¸ ë‚˜ë¦¬íƒ€ ê³µí•­ 2Â·3í„°ë¯¸ë„ ë„ì°© í›„ ì¶œêµ­ì¥ ì´ë™</div>
        <div id="photos-day5"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day5', this)"></label>
        <textarea id="memo-day5" onblur="saveMemo('day5')"></textarea>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="go(1)">16(ëª©)<br>1ì¼ì°¨</div>
        <div class="nav-item" onclick="go(2)">17(ê¸ˆ)<br>2ì¼ì°¨</div>
        <div class="nav-item" onclick="go(3)">18(í† )<br>3ì¼ì°¨</div>
        <div class="nav-item" onclick="go(4)">19(ì¼)<br>4ì¼ì°¨</div>
        <div class="nav-item" onclick="go(5)">20(ì›”)<br>5ì¼ì°¨</div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
    import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-storage.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBweeHd4dCsd82Q2pDxPnP9IU6vjdi-S5M",
        authDomain: "tokyo-trip-2026-family.firebaseapp.com",
        projectId: "tokyo-trip-2026-family",
        storageBucket: "tokyo-trip-2026-family.firebasestorage.app",
        messagingSenderId: "669648921196",
        appId: "1:669648921196:web:79df32780bea9a4e6dee49"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    window.checkPassword = () => {
        const input = document.getElementById('pw-input').value.trim();
        if (input === "1214") {
            document.getElementById('lock-screen').style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!");
        }
    };

    window.uploadPhoto = async (day, input) => {
        if (!input.files[0]) return;
        const file = input.files[0];
        const fileName = Date.now() + "_" + file.name;
        const storageRef = ref(storage, "photos/" + day + "/" + fileName);
        try {
            const snap = await uploadBytes(storageRef, file);
            const url = await getDownloadURL(snap.ref);
            await setDoc(doc(db, "travel", day), { photos: arrayUnion({ url, name: fileName }) }, { merge: true });
        } catch (e) { alert("ì €ì¥ ì‹¤íŒ¨!"); }
    };

    window.deletePhoto = async (day, photoData) => {
        if (!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
        try {
            await deleteObject(ref(storage, "photos/" + day + "/" + photoData.name));
            await updateDoc(doc(db, "travel", day), { photos: arrayRemove(photoData) });
        } catch (e) { alert("ì‚­ì œ ì‹¤íŒ¨!"); }
    };

    window.saveMemo = async (day) => {
        const val = document.getElementById("memo-" + day).value;
        await setDoc(doc(db, "travel", day), { memo: val }, { merge: true });
    };

    window.go = (n) => {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.getElementById('day' + n).classList.add('active');
        document.querySelectorAll('.nav-item')[n-1].classList.add('active');
        window.scrollTo(0,0);
    };

    ['day1','day2','day3','day4','day5'].forEach(day => {
        onSnapshot(doc(db, "travel", day), (docSnap) => {
            if (docSnap.exists()) {
                const data = docSnap.data();
                if (document.getElementById("memo-" + day)) document.getElementById("memo-" + day).value = data.memo || "";
                const photoDiv = document.getElementById("photos-" + day);
                if (photoDiv) {
                    photoDiv.innerHTML = (data.photos || []).map(p => `
                        <div class="photo-container">
                            <img src="${p.url}" class="photo-item">
                            <button class="del-btn" onclick="deletePhoto('${day}', ${JSON.stringify(p).replace(/"/g, '&quot;')})">âœ•</button>
                        </div>
                    `).join('');
                }
            }
        });
    });
</script>
</body>
</html>
