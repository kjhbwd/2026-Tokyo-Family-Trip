<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë„ì¿„ ê°€ì¡±ì—¬í–‰ 2026 - ìµœì¢…ë³¸</title>
    <style>
        :root { --main: #ff4757; --bg: #f8f9fa; --card: #ffffff; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 100px; color: #333; }
        #lock-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--main); color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; }
        #pw-input { width: 180px; padding: 15px; border: none; border-radius: 10px; text-align: center; font-size: 1.5rem; margin-bottom: 20px; outline: none; letter-spacing: 5px; }
        #lock-screen button { padding: 12px 40px; border: none; border-radius: 25px; background: white; color: var(--main); font-weight: bold; cursor: pointer; }
        #app-content { display: none; }
        .header { background: var(--main); color: white; padding: 15px; text-align: center; position: sticky; top: 0; z-index: 100; font-weight: bold; }
        .card { background: var(--card); margin: 15px; padding: 20px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); display: none; }
        .card.active { display: block; }
        h2 { font-size: 1.2rem; color: var(--main); margin-top: 0; border-bottom: 2px solid #fff0f1; padding-bottom: 8px; }
        .info-item { font-size: 0.95rem; margin-bottom: 10px; padding-left: 12px; border-left: 4px solid #ff4757; line-height: 1.6; }
        .photo-container { position: relative; display: inline-block; margin: 5px; }
        .photo-item { width: 105px; height: 105px; object-fit: cover; border-radius: 12px; border: 1px solid #eee; }
        .del-btn { position: absolute; top: -5px; right: -5px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; }
        textarea { width: 100%; height: 120px; border: 1px solid #eee; border-radius: 12px; padding: 12px; margin-top: 20px; box-sizing: border-box; background: #fffdf0; font-size: 0.9rem; }
        .upload-btn { display: inline-block; padding: 10px 20px; background: #f0f0f0; border-radius: 10px; font-size: 0.9rem; cursor: pointer; margin-top: 15px; border: 1px solid #ddd; font-weight: bold; }
        .nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; border-top: 1px solid #eee; height: 75px; z-index: 100; }
        .nav-item { flex: 1; text-align: center; padding: 12px 0; color: #999; cursor: pointer; font-size: 0.8rem; }
        .nav-item.active { color: var(--main); font-weight: bold; background: #fffafa; }
    </style>
</head>
<body>

<div id="lock-screen">
    <h2>ğŸ”‘ ê°€ì¡± ì „ìš© ì•”í˜¸</h2>
    <input type="password" id="pw-input" maxlength="4" placeholder="4ìë¦¬" inputmode="numeric">
    <button onclick="checkPassword()">ì…ì¥í•˜ê¸°</button>
</div>

<div id="app-content">
    <div class="header">ë„ì¿„ ê°€ì¡±ì—¬í–‰ 2026 ğŸ‡¯ğŸ‡µ</div>

    <div id="day1" class="card active">
        <h2>DAY 1: ê³µí•­ & ì•„ì‚¬ì¿ ì‚¬ (1/16)</h2>
        <div class="info-item">âœˆï¸ 15:00 ë‚˜ë¦¬íƒ€ ê³µí•­ ë„ì°©</div>
        <div class="info-item">ğŸš† ìŠ¤ì¹´ì´ë¼ì´ë„ˆ íƒ€ê³  ìš°ì—ë…¸ ì´ë™ (40ë¶„ ì†Œìš”)</div>
        <div class="info-item">ğŸ¨ ì•„ì‚¬ì¿ ì‚¬ ë·° í˜¸í…” ì²´í¬ì¸ ë° ì§ í’€ê¸°</div>
        <div class="info-item">ğŸ® ì„¼ì†Œì§€ & ë‚˜ì¹´ë¯¸ì„¸ ê±°ë¦¬ ì‚°ì±… ë° êµ¬ê²½</div>
        <div class="info-item">ğŸ´ ì €ë…: ì•„ì‚¬ì¿ ì‚¬ ì£¼ë³€ ì •í†µ ì¼ì‹ ë§›ì§‘</div>
        <div id="photos-day1" style="margin-top:20px;"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day1', this)"></label>
        <textarea id="memo-day1" onblur="saveMemo('day1')" placeholder="ë„ì°© ì†Œê°ì„ ë‚¨ê¸°ì„¸ìš”!"></textarea>
    </div>

    <div id="day2" class="card">
        <h2>DAY 2: ë””ì¦ˆë‹ˆì”¨ (1/17)</h2>
        <div class="info-item">ğŸ¡ 08:30 ë„ì¿„ ë””ì¦ˆë‹ˆì”¨ ì…ì¥</div>
        <div class="info-item">ğŸ¢ ì¸ê¸° ì–´íŠ¸ë™ì…˜ ìš°ì„  íƒ‘ìŠ¹ ë„ì „!</div>
        <div class="info-item">ğŸ— ì ì‹¬: íŒŒí¬ ë‚´ í…Œë§ˆ ë ˆìŠ¤í† ë‘ ì‹ì‚¬</div>
        <div class="info-item">ğŸŒ‹ ì €ë…: í•˜ë²„ ì‡¼ & 'ë¹Œë¦¬ë¸Œ' ê´€ëŒ</div>
        <div class="info-item">ğŸ° ë¶ˆê½ƒë†€ì´ ê°ìƒ í›„ ì•„ì‚¬ì¿ ì‚¬ ë³µê·€</div>
        <div id="photos-day2" style="margin-top:20px;"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day2', this)"></label>
        <textarea id="memo-day2" onblur="saveMemo('day2')"></textarea>
    </div>

    <div id="day3" class="card">
        <h2>DAY 3: ì‹œë¶€ì•¼ & ì‹ ì£¼ì¿  (1/18)</h2>
        <div class="info-item">ğŸ™ï¸ ì‹œë¶€ì•¼ ìŠ¤ì¹´ì´ ì „ë§ëŒ€ (ë„ì¿„ ì‹œë‚´ ì¡°ë§)</div>
        <div class="info-item">ğŸš¶ ìŠ¤í¬ë¨ë¸” êµì°¨ë¡œ & í•˜ì¹˜ì½” ë™ìƒ ì‚¬ì§„ ì´¬ì˜</div>
        <div class="info-item">ğŸ›ï¸ ì‹ ì£¼ì¿  ë°±í™”ì ê°€ ì‡¼í•‘ ë° ëˆí‚¤í˜¸í…Œ ë°©ë¬¸</div>
        <div class="info-item">ğŸ® ì €ë…: ì˜¤ëª¨ì´ë° ìš”ì½”ì´ˆ ê°ì„± ê±°ë¦¬</div>
        <div id="photos-day3" style="margin-top:20px;"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day3', this)"></label>
        <textarea id="memo-day3" onblur="saveMemo('day3')"></textarea>
    </div>

    <div id="day4" class="card">
        <h2>DAY 4: í•˜ë¼ì£¼ì¿  & ì˜¤ëª¨í…Œì‚°ë„ (1/19)</h2>
        <div class="info-item">ğŸŒ³ ë©”ì´ì§€ ì‹ ê¶ ìˆ²ê¸¸ ì‚°ì±…</div>
        <div class="info-item">ğŸ¥ í•˜ë¼ì£¼ì¿  ë‹¤ì¼€ì‹œíƒ€ ê±°ë¦¬ ë””ì €íŠ¸ íˆ¬ì–´</div>
        <div class="info-item">ğŸ‘— ì˜¤ëª¨í…Œì‚°ë„ íì¦ˆ & ëª…í’ˆ ê±°ë¦¬ êµ¬ê²½</div>
        <div class="info-item">ğŸ—¼ ì €ë…: ë„ì¿„íƒ€ì›Œ ì•¼ê²½ ë° ê·¼ì²˜ ì‹ì‚¬</div>
        <div id="photos-day4" style="margin-top:20px;"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day4', this)"></label>
        <textarea id="memo-day4" onblur="saveMemo('day4')"></textarea>
    </div>

    <div id="day5" class="card">
        <h2>DAY 5: ì‹œì¥ íˆ¬ì–´ & ê·€êµ­ (1/20)</h2>
        <div class="info-item">ğŸ£ ì¸ í‚¤ì§€ ì¥ì™¸ ì‹œì¥ ì•„ì¹¨ ì‹ì‚¬</div>
        <div class="info-item">ğŸ›ï¸ ìš°ì—ë…¸ ì•„ë©”ìš”ì½” ì‹œì¥ ë§ˆì§€ë§‰ ì‡¼í•‘</div>
        <div class="info-item">ğŸš† 16:00 ë‚˜ë¦¬íƒ€ ê³µí•­ ì´ë™ ë° ìˆ˜ì†</div>
        <div class="info-item">âœˆï¸ ì €ë… ë¹„í–‰ê¸°ë¡œ ì¸ì²œ ê³µí•­ ê·€êµ­</div>
        <div id="photos-day5" style="margin-top:20px;"></div>
        <label class="upload-btn">ğŸ“· ì‚¬ì§„ ì¶”ê°€ <input type="file" hidden onchange="uploadPhoto('day5', this)"></label>
        <textarea id="memo-day5" onblur="saveMemo('day5')"></textarea>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="go(1)">16(ëª©)<br>1ì¼ì°¨</div>
        <div class="nav-item" onclick="go(2)">17(ê¸ˆ)<br>2ì¼ì°¨</div>
        <div class="nav-item" onclick="go(3)">18(í† )<br>3ì¼ì°¨</div>
        <div class="nav-item" onclick="go(4)">19(ì¼)<br>4ì¼ì°¨</div>
        <div class="nav-item" onclick="go(5)">20(ì›”)<br>5ì¼ì°¨</div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
    import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-storage.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBweeHd4dCsd82Q2pDxPnP9IU6vjdi-S5M",
        authDomain: "tokyo-trip-2026-family.firebaseapp.com",
        projectId: "tokyo-trip-2026-family",
        storageBucket: "tokyo-trip-2026-family.firebasestorage.app",
        messagingSenderId: "669648921196",
        appId: "1:669648921196:web:79df32780bea9a4e6dee49"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    window.checkPassword = () => {
        const input = document.getElementById('pw-input').value.trim();
        if (input === "1214") {
            document.getElementById('lock-screen').style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!");
        }
    };

    window.uploadPhoto = async (day, input) => {
        if (!input.files[0]) return;
        const file = input.files[0];
        const fileName = Date.now() + "_" + file.name;
        const storageRef = ref(storage, "photos/" + day + "/" + fileName);
        try {
            const snap = await uploadBytes(storageRef, file);
            const url = await getDownloadURL(snap.ref);
            await setDoc(doc(db, "travel", day), { photos: arrayUnion({ url, name: fileName }) }, { merge: true });
        } catch (e) { alert("ì €ì¥ ì‹¤íŒ¨!"); }
    };

    window.deletePhoto = async (day, photoData) => {
        if (!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
        try {
            await deleteObject(ref(storage, "photos/" + day + "/" + photoData.name));
            await updateDoc(doc(db, "travel", day), { photos: arrayRemove(photoData) });
        } catch (e) { alert("ì‚­ì œ ì‹¤íŒ¨!"); }
    };

    window.saveMemo = async (day) => {
        const val = document.getElementById("memo-" + day).value;
        await setDoc(doc(db, "travel", day), { memo: val }, { merge: true });
    };

    window.go = (n) => {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.getElementById('day' + n).classList.add('active');
        document.querySelectorAll('.nav-item')[n-1].classList.add('active');
        window.scrollTo(0,0);
    };

    ['day1','day2','day3','day4','day5'].forEach(day => {
        onSnapshot(doc(db, "travel", day), (docSnap) => {
            if (docSnap.exists()) {
                const data = docSnap.data();
                if (document.getElementById("memo-" + day)) document.getElementById("memo-" + day).value = data.memo || "";
                const photoDiv = document.getElementById("photos-" + day);
                if (photoDiv) {
                    photoDiv.innerHTML = (data.photos || []).map(p => `
                        <div class="photo-container">
                            <img src="${p.url}" class="photo-item">
                            <button class="del-btn" onclick="deletePhoto('${day}', ${JSON.stringify(p).replace(/"/g, '&quot;')})">âœ•</button>
                        </div>
                    `).join('');
                }
            }
        });
    });
</script>
</body>
</html>
